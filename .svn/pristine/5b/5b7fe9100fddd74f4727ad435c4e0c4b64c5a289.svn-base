"use strict";(self.webpackChunkAIOAcessControl_WebApp=self.webpackChunkAIOAcessControl_WebApp||[]).push([[6459],{6459:(Ft,x,l)=>{l.r(x),l.d(x,{TCardNoModule:()=>St});var u=l(6019),I=l(4382),T=l(9711),q=l(8576),Z=l(6154),O=l(4646),v=l(2300),N=l(9594),A=l(6765),f=l(9859),k=l(5351),c=l(9133),y=l(8977),U=l(2262),m=l(4176),Q=l(1125),b=l(8053),d=l(9839),t=l(3668),g=l(5304),S=l(563),F=l(888),V=l(5694),h=l(5243),_=l(8167),J=l(5498),w=l(138),R=l(86),Y=l(904),H=l(7444),B=l(9112),D=l(9851),G=l(6400),P=l(6731);const j=["modal"];function z(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw().openDialog("create")}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"button.createButton")," "))}function $(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){return t.CHM(e),t.oxw().removeData()}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("disabled",0==e.selection.selected.length),t.xp6(1),t.hij("",t.lcZ(2,2,"button.deleteButton")," ")}}function W(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"th",33),t.TgZ(1,"mat-checkbox",34),t.NdJ("change",function(n){t.CHM(e);const i=t.oxw(2);return n?i.masterToggle():null}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function X(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"td",35),t.TgZ(1,"mat-checkbox",36),t.NdJ("click",function(n){return n.stopPropagation()})("change",function(n){const s=t.CHM(e).$implicit,p=t.oxw(2);return n?p.selection.toggle(s):null}),t.qZA(),t.qZA()}if(2&a){const e=r.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("checked",o.selection.isSelected(e))("aria-label",o.checkboxLabel(e))}}function K(a,r){1&a&&(t.TgZ(0,"th",37),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"button.positionCol")))}function tt(a,r){if(1&a&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&a){const e=r.index,o=t.oxw(2);t.xp6(1),t.Oqu(e+1+o.page*o.pageSize)}}function et(a,r){1&a&&(t.TgZ(0,"th",38),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"TCardNo.cardNoEmployeeCol")))}function at(a,r){if(1&a&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.emName)}}function ot(a,r){1&a&&(t.TgZ(0,"th",38),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"TCardNo.cardNumberCol")))}function it(a,r){if(1&a&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.caNumber)}}function nt(a,r){1&a&&(t.TgZ(0,"th",38),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"TCardNo.cardNoCol")))}function rt(a,r){if(1&a&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.caNo)}}function lt(a,r){1&a&&(t.TgZ(0,"th",38),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"TCardNo.cardStatusCol")))}function st(a,r){if(1&a&&(t.TgZ(0,"td",35),t.TgZ(1,"mat-checkbox",39),t.NdJ("click",function(o){return o.preventDefault()}),t.qZA(),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Q6J("disableRipple",!0)("checked",e.caStatus)}}function ct(a,r){1&a&&(t.TgZ(0,"th",40),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"button.actionCol")))}function dt(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"a",42),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit;return t.oxw(2).openDialog("edit",n)}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA(),t.qZA()}2&a&&t.s9C("matTooltip",t.lcZ(1,1,"button.editButton"))}function mt(a,r){1&a&&(t.TgZ(0,"td",35),t.YNc(1,dt,4,3,"a",41),t.ALo(2,"userRoles"),t.qZA()),2&a&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,"UpdateTCardNo")))}function pt(a,r){1&a&&t._UZ(0,"tr",43)}function ut(a,r){1&a&&t._UZ(0,"tr",44)}function gt(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",15),t.TgZ(1,"div",16),t.TgZ(2,"table",17),t.ynx(3,18),t.YNc(4,W,2,3,"th",19),t.YNc(5,X,2,2,"td",20),t.BQk(),t.ynx(6,21),t.YNc(7,K,3,3,"th",22),t.YNc(8,tt,2,1,"td",20),t.BQk(),t.ynx(9,23),t.YNc(10,et,3,3,"th",24),t.YNc(11,at,2,1,"td",20),t.BQk(),t.ynx(12,25),t.YNc(13,ot,3,3,"th",24),t.YNc(14,it,2,1,"td",20),t.BQk(),t.ynx(15,26),t.YNc(16,nt,3,3,"th",24),t.YNc(17,rt,2,1,"td",20),t.BQk(),t.ynx(18,27),t.YNc(19,lt,3,3,"th",24),t.YNc(20,st,2,2,"td",20),t.BQk(),t.ynx(21,28),t.YNc(22,ct,3,3,"th",29),t.YNc(23,mt,3,3,"td",20),t.BQk(),t.YNc(24,pt,1,0,"tr",30),t.YNc(25,ut,1,0,"tr",31),t.qZA(),t.qZA(),t.TgZ(26,"mat-paginator",32),t.NdJ("page",function(n){return t.CHM(e),t.oxw().onChangePage(n)}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(2),t.Q6J("dataSource",e.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",e.pageSizeOptions)("pageIndex",e.page)("length",e.totalRow)("disabled",!1)}}function ht(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",79),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).emPloyeeControl.reset()}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA(),t.qZA()}}function _t(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"mat-option",80),t.NdJ("onSelectionChange",function(n){const s=t.CHM(e).$implicit;return t.oxw(2).onchangeEmployee(n,s)}),t._uU(1),t.qZA()}if(2&a){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.emName," ")}}function ft(a,r){1&a&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"pVehicleModule.emNameRequired")," "))}function Ct(a,r){1&a&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"pVehicleModule.emNameDifferent")," "))}function xt(a,r){if(1&a&&(t.TgZ(0,"mat-option",81),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Tt(a,r){1&a&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TCardNo.cardNumberInvalid")," "))}function Zt(a,r){1&a&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TCardNo.cardNoInvalid")," "))}function vt(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"mat-option",80),t.NdJ("onSelectionChange",function(n){const s=t.CHM(e).$implicit;return t.oxw(2).checkConnection(n,s)}),t._uU(1),t.qZA()}if(2&a){const e=r.$implicit;t.Q6J("value",e.devId),t.xp6(1),t.hij(" ",e.devName," ")}}function Nt(a,r){1&a&&(t.TgZ(0,"div"),t.TgZ(1,"mat-checkbox",82),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.qZA()),2&a&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"TCardNo.cardStatusCol"),""))}const L=function(){return{standalone:!0}};function At(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"mat-radio-group",83),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).caState=n}),t.TgZ(1,"mat-radio-button",84),t._uU(2,"Th\u1ebb ho\u1ea1t \u0111\u1ed9ng"),t.qZA(),t.TgZ(3,"mat-radio-button",85),t._uU(4,"Th\u1ebb h\u1ecfng"),t.qZA(),t.TgZ(5,"mat-radio-button",86),t._uU(6,"Th\u1ebb m\u1ea5t"),t.qZA(),t.TgZ(7,"mat-radio-button",87),t._uU(8,"Th\u1ebb h\u1ee7y"),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(2);t.Q6J("ngModel",e.caState)("ngModelOptions",t.DdM(2,L))}}function yt(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"form",45),t.TgZ(1,"h2",46),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-dialog-content",47),t.TgZ(5,"div",48),t.TgZ(6,"mat-form-field",49),t.TgZ(7,"mat-label"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t._UZ(10,"input",50),t.ALo(11,"translate"),t.YNc(12,ht,3,0,"button",51),t.TgZ(13,"mat-autocomplete",52,53),t.YNc(15,_t,2,2,"mat-option",54),t.ALo(16,"async"),t.qZA(),t.YNc(17,ft,3,3,"mat-error",55),t.YNc(18,Ct,3,3,"mat-error",55),t.qZA(),t.TgZ(19,"mat-form-field",56),t.TgZ(20,"mat-label"),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"mat-select",57),t.YNc(24,xt,2,2,"mat-option",58),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",48),t.TgZ(26,"mat-form-field",49),t.TgZ(27,"mat-label"),t._uU(28),t.ALo(29,"translate"),t.qZA(),t._UZ(30,"input",59,60),t.ALo(32,"translate"),t.TgZ(33,"mat-hint",61),t._uU(34),t.qZA(),t.YNc(35,Tt,3,3,"mat-error",55),t.qZA(),t.TgZ(36,"mat-form-field",62),t.TgZ(37,"mat-label"),t._uU(38),t.ALo(39,"translate"),t.qZA(),t._UZ(40,"input",63,64),t.ALo(42,"translate"),t.TgZ(43,"mat-hint",61),t._uU(44),t.qZA(),t.YNc(45,Zt,3,3,"mat-error",55),t.qZA(),t.qZA(),t.TgZ(46,"div",48),t.TgZ(47,"mat-form-field",65),t.TgZ(48,"mat-label"),t._uU(49),t.ALo(50,"translate"),t.qZA(),t.TgZ(51,"mat-select",66),t.NdJ("valueChange",function(n){return t.CHM(e),t.oxw().devId=n}),t.YNc(52,vt,2,2,"mat-option",54),t.qZA(),t.qZA(),t.TgZ(53,"div",67),t.TgZ(54,"button",68),t.NdJ("click",function(){return t.CHM(e),t.oxw().getCaNo()}),t._uU(55),t.ALo(56,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(57,"div",69),t.TgZ(58,"div",7),t.TgZ(59,"mat-form-field",70),t.TgZ(60,"mat-label"),t._uU(61),t.ALo(62,"translate"),t.qZA(),t._UZ(63,"input",71),t.ALo(64,"translate"),t.qZA(),t.qZA(),t.TgZ(65,"div",72),t.TgZ(66,"mat-checkbox",73),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().timelimit=n})("change",function(){return t.CHM(e),t.oxw().timeLimitChange()}),t.qZA(),t.TgZ(67,"mat-label"),t._uU(68),t.ALo(69,"translate"),t.qZA(),t.qZA(),t.TgZ(70,"div",7),t.TgZ(71,"mat-form-field",70),t.TgZ(72,"mat-label"),t._uU(73),t.ALo(74,"translate"),t.qZA(),t._UZ(75,"input",74),t.ALo(76,"translate"),t.qZA(),t.qZA(),t.qZA(),t.YNc(77,Nt,4,3,"div",55),t.YNc(78,At,9,3,"mat-radio-group",75),t.qZA(),t.TgZ(79,"mat-dialog-actions",76),t.TgZ(80,"button",77),t.NdJ("click",function(){return t.CHM(e),t.oxw().onReset()}),t._uU(81),t.ALo(82,"translate"),t.qZA(),t.TgZ(83,"button",78),t.NdJ("click",function(){return t.CHM(e),t.oxw().addData()}),t._uU(84),t.ALo(85,"translate"),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(14),o=t.MAs(31),n=t.MAs(41),i=t.oxw();t.Q6J("formGroup",i.Form),t.xp6(2),t.Oqu(t.lcZ(3,41,i.title)),t.xp6(6),t.Oqu(t.lcZ(9,43,"pVehicleModule.emNameCol")),t.xp6(2),t.s9C("placeholder",t.lcZ(11,45,"pVehicleModule.emNameCol")),t.Q6J("readonly","edit"==i.action)("formControl",i.emPloyeeControl)("matAutocomplete",e),t.xp6(2),t.Q6J("ngIf","edit"!=i.action&&i.emPloyeeControl.value),t.xp6(1),t.Q6J("displayWith",i.displayEmployee),t.xp6(2),t.Q6J("ngForOf",t.lcZ(16,47,i.employeeOptions)),t.xp6(2),t.Q6J("ngIf",i.emPloyeeControl.hasError("required")),t.xp6(1),t.Q6J("ngIf",!i.emPloyeeControl.hasError("required")&&i.emPloyeeControl.hasError("invalidAutocompleteObject")),t.xp6(3),t.Oqu(t.lcZ(22,49,"TCardNo.useForCol")),t.xp6(2),t.Q6J("disabled","edit"==i.action),t.xp6(1),t.Q6J("ngForOf",i.cardTypes),t.xp6(4),t.Oqu(t.lcZ(29,51,"TCardNo.cardNumberCol")),t.xp6(2),t.s9C("placeholder",t.lcZ(32,53,"TCardNo.cardNumberCol")),t.xp6(4),t.hij("",o.value.length," / 30"),t.xp6(1),t.Q6J("ngIf",i.getValidForm.caNumber.invalid),t.xp6(3),t.Oqu(t.lcZ(39,55,"TCardNo.cardNoCol")),t.xp6(2),t.s9C("placeholder",t.lcZ(42,57,"TCardNo.cardNoCol")),t.Q6J("readonly","edit"==i.action),t.xp6(4),t.hij("",n.value.length," / 30"),t.xp6(1),t.Q6J("ngIf",i.getValidForm.caNo.invalid),t.xp6(4),t.Oqu(t.lcZ(50,59,"TCardNo.cardDevCol")),t.xp6(2),t.Q6J("value",i.devId)("disabled","edit"==i.action),t.xp6(1),t.Q6J("ngForOf",i.devices),t.xp6(2),t.Q6J("disabled",!i.connectedDev||"edit"==i.action),t.xp6(1),t.Oqu(t.lcZ(56,61,"TCardNo.getCaNO")),t.xp6(6),t.Oqu(t.lcZ(62,63,"TCardNo.cardApplyDateCol")),t.xp6(2),t.s9C("placeholder",t.lcZ(64,65,"TCardNo.cardApplyDateCol")),t.xp6(3),t.Q6J("ngModel",i.timelimit)("ngModelOptions",t.DdM(77,L)),t.xp6(2),t.Oqu(t.lcZ(69,67,"TCardNo.cardExpriedCol")),t.xp6(5),t.Oqu(t.lcZ(74,69,"TCardNo.cardExpriedDateCol")),t.xp6(2),t.s9C("placeholder",t.lcZ(76,71,"TCardNo.cardExpriedDateCol")),t.xp6(2),t.Q6J("ngIf","create"==i.action),t.xp6(1),t.Q6J("ngIf","create"!=i.action),t.xp6(3),t.Oqu(t.lcZ(82,73,"button.cancelButton")),t.xp6(3),t.Oqu(t.lcZ(85,75,"button.saveButton"))}}const bt=[{path:"",component:(()=>{class a{constructor(e,o,n,i,s,p,C){this.dataService=e,this.dialog=o,this.notificationService=n,this.pagin=i,this.translateService=s,this.formBuilder=p,this.datepipe=C,this.displayedColumns=["select","position","employeeName","caNumber","caNo","caStatus","action"],this.dataSource=new m.by,this.preventAbuse=!1,this.page=0,this.keyword="",this.totalRow=0,this.totalPage=0,this.connectedDev=!1,this.selection=new k.Ov(!0,[]),this.action="",this.title="",this.pageSizeOptions=[10,25,50,100],this.pageSize=this.pageSizeOptions[0],this.isAllChecked=!1,this.fromDate=this.datepipe.transform(Date.now(),"yyyy-MM-dd"),this.toDate=this.datepipe.transform(Date.now(),"yyyy-MM-dd"),this.caState="",this.status=!0,this.timelimit=!1,this.cardTypes=[{id:0,name:"Access Control Management"},{id:1,name:"Parking Management"}],this.emPloyeeControl=new c.NI("",{validators:[this.autocompleteObjectValidator(),c.kI.required]}),this.devId=0,this.formRegister()}ngOnInit(){this.getAllData(),this.getAllEmployee(),this.getAllDevice()}formRegister(){this.Form=this.formBuilder.group({caId:0,emId:["",c.kI.compose([c.kI.required])],caNo:["",c.kI.compose([c.kI.required,c.kI.maxLength(30)])],caNumber:["",c.kI.compose([c.kI.required,c.kI.maxLength(30)])],emIdCreated:"",caTypeCheck:0,caStatus:!0,using:!0,caDamaged:!1,caLost:!1,destroyed:!1,destroyedDate:"",applyDate:this.datepipe.transform(Date.now(),"yyyy-MM-dd"),expriedDate:[{value:"",disabled:!this.timelimit}],dateEdit:this.datepipe.transform(Date.now(),"yyyy-MM-dd")})}autocompleteObjectValidator(){return e=>"string"==typeof e.value?{invalidAutocompleteObject:{value:e.value}}:null}_filterEmployee(e){const o=null==e?void 0:e.toLowerCase();return this.employees.filter(n=>null==n?void 0:n.emName.toLowerCase().includes(o))}onchangeDevice(e,o){e.source.selected&&this.Form.controls.emId.setValue(o.emId)}onchangeEmployee(e,o){e.source.selected&&this.Form.controls.emId.setValue(o.emId)}displayEmployee(e){return e&&e.emName?e.emName:""}openDialog(e,o,n){this.action=e,this.timelimit=!1;var i=JSON.parse(localStorage.CURRENT_USER).emId;if(this.Form.controls.emIdCreated.setValue(i),"create"==e){this.translateService.get("TCardNo.CreateCard").subscribe(p=>this.title=p),this.Form.controls.caStatus.setValue(!0),this.Form.controls.applyDate.setValue(this.datepipe.transform(Date.now(),"yyyy-MM-dd")),this.Form.controls.dateEdit.setValue(""),this.Form.controls.caTypeCheck.setValue(0);const s=this.dialog.open(this.dialogTemplate,{width:"800px",autoFocus:!1});s.disableClose=!0,s.afterClosed().subscribe(p=>{this.onReset()})}else this.dataService.get("TCardNo/getmappingbycaid?id="+o.caId).subscribe(s=>{var p=this.datepipe.transform(s.applyDate,"yyyy-MM-dd"),C=this.datepipe.transform(s.expriedDate,"yyyy-MM-dd");this.translateService.get("TCardNo.EditCard").subscribe(M=>this.title=M),this.emPloyeeControl.setValue(s),this.Form.controls.caId.setValue(s.caId),this.Form.controls.emId.setValue(s.emId),this.Form.controls.caNo.setValue(s.caNo),this.Form.controls.caNumber.setValue(s.caNumber),this.Form.controls.using.setValue(s.using),this.Form.controls.emIdCreated.setValue(s.emIdCreated),this.Form.controls.caTypeCheck.setValue(s.caTypeCheck),this.Form.controls.applyDate.setValue(p),this.Form.controls.expriedDate.setValue(C),this.Form.controls.dateEdit.setValue(this.datepipe.transform(Date.now(),"yyyy-MM-dd HH:mm:ss")),null!=s.expriedDate?(this.timelimit=!0,this.Form.controls.expriedDate.enable()):(this.timelimit=!1,this.Form.controls.expriedDate.disable()),1==s.caStatus&&(this.caState="caStatus"),1==s.caDamaged&&(this.caState="caDamaged"),1==s.caLost&&(this.caState="caLost"),1==s.destroyed&&(this.caState="destroyed");const E=this.dialog.open(this.dialogTemplate,{width:"800px",autoFocus:!1});E.disableClose=!0,E.afterClosed().subscribe(M=>{this.onReset()})},s=>{})}timeLimitChange(){1==this.timelimit?(this.Form.controls.expriedDate.enable(),this.Form.controls.expriedDate.setValue(this.datepipe.transform(Date.now(),"yyyy-MM-dd"))):(this.Form.controls.expriedDate.disable(),this.Form.controls.expriedDate.setValue(""))}getAllEmployee(){this.preventAbuse=!0,this.dataService.get("TEmployee/getAllNoParam").subscribe(e=>{this.employees=e,this.preventAbuse=!1,this.employeeOptions=this.emPloyeeControl.valueChanges.pipe((0,Q.O)(""),(0,b.U)(o=>null==o||"string"==typeof o?o:o.emName),(0,b.U)(o=>o?this._filterEmployee(o):this.employees.slice()))},e=>{this.translateService.get("messageSystem.loadFail").subscribe(o=>d.Q.GET_FAILSE_MSG=o),this.notificationService.printErrorMessage(d.Q.GET_FAILSE_MSG),this.preventAbuse=!1})}getAllDevice(){this.preventAbuse=!0,this.dataService.get("TDevice/getall").subscribe(e=>{this.devices=e,this.preventAbuse=!1},e=>{this.translateService.get("messageSystem.loadFail").subscribe(o=>d.Q.GET_FAILSE_MSG=o),this.notificationService.printErrorMessage(d.Q.GET_FAILSE_MSG),this.preventAbuse=!1})}getAllData(){this.preventAbuse=!0,this.dataService.get("TCardNo/getlistpaging?page="+this.page+"&pageSize="+this.pageSize+"&keyword="+this.keyword).subscribe(e=>{this.dataSource=new m.by(e.items),this.dataSource.sort=this.sort,this.totalRow=e.totalCount},e=>{this.translateService.get("messageSystem.loadFail").subscribe(o=>d.Q.GET_FAILSE_MSG=o),this.notificationService.printErrorMessage(d.Q.GET_FAILSE_MSG)}),this.preventAbuse=!1}applyFilter(e){this.keyword=e.target.value,this.page=0,this.getAllData(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}get getValidForm(){return this.Form.controls}addData(){if(!this.Form.invalid){if(this.preventAbuse=!0,"create"==this.action){var e=JSON.parse(localStorage.CURRENT_USER).emId;this.Form.controls.using.setValue(!0),this.Form.controls.caDamaged.setValue(!1),this.Form.controls.caLost.setValue(!1),this.Form.controls.destroyed.setValue(!1),null!=e&&this.Form.controls.emIdCreated.setValue(e),this.dataService.post("TCardNo/create",this.Form.value).subscribe(n=>{let i;this.translateService.get("messageSystem.createSuccess").subscribe(s=>i=s),this.notificationService.printSuccessMessage(i),this.getAllData(),this.dialog.closeAll(),this.onReset()},n=>{let i;this.translateService.get("messageSystem.createFail").subscribe(s=>i=s),this.notificationService.printErrorMessage(i)})}else"edit"==this.action&&("caStatus"==this.caState?(this.Form.controls.caStatus.setValue(!0),this.Form.controls.caDamaged.setValue(!1),this.Form.controls.caLost.setValue(!1),this.Form.controls.destroyed.setValue(!1)):"caDamaged"==this.caState?(this.Form.controls.caStatus.setValue(!1),this.Form.controls.caDamaged.setValue(!0),this.Form.controls.caLost.setValue(!1),this.Form.controls.destroyed.setValue(!1)):"caLost"==this.caState?(this.Form.controls.caStatus.setValue(!1),this.Form.controls.caDamaged.setValue(!1),this.Form.controls.caLost.setValue(!0),this.Form.controls.destroyed.setValue(!1)):"destroyed"==this.caState&&(this.Form.controls.caStatus.setValue(!1),this.Form.controls.caDamaged.setValue(!1),this.Form.controls.caLost.setValue(!1),this.Form.controls.destroyed.setValue(!0),this.Form.controls.destroyedDate.setValue(this.datepipe.transform(Date.now(),"yyyy-MM-dd HH:mm:ss"))),this.dataService.put("TCardNo/update",this.Form.value).subscribe(n=>{let i;this.translateService.get("messageSystem.updateSuccess").subscribe(s=>i=s),this.notificationService.printSuccessMessage(i),this.getAllData(),this.getAllEmployee(),this.dialog.closeAll(),this.onReset()},n=>{let i;this.translateService.get("messageSystem.updateFail").subscribe(s=>i=s),this.notificationService.printErrorMessage(i)}));this.onReset(),this.preventAbuse=!1}}onReset(){this.devId=0,this.connectedDev=!1,this.dialog.closeAll(),this.Form.reset(),this.Form.controls.caId.setValue(0),this.emPloyeeControl.reset(),this.caState=""}removeData(){let e=[];this.selection.selected.forEach(o=>{e.push(o.caId)}),this.translateService.get("messageSystem.confirmDelete").subscribe(o=>d.Q.CONFIRM_DELETE_MSG=o),this.notificationService.printConfirmationDialog(d.Q.CONFIRM_DELETE_MSG,()=>this.deleteItemConfirm(JSON.stringify(e)))}deleteItemConfirm(e){this.preventAbuse=!0,this.dataService.delete("TCardNo/lockmulti","checkedList",e).subscribe(o=>{this.translateService.get("messageSystem.deleteSuccess").subscribe(n=>d.Q.DELETED_OK_MSG=n),this.translateService.get("messageSystem.deleteFail").subscribe(n=>d.Q.DELETE_FAILSE_MSG=n),o[0]>0&&this.notificationService.printSuccessMessage(d.Q.DELETED_OK_MSG+o[0]),o[1]>0&&this.notificationService.printErrorMessage(d.Q.DELETE_FAILSE_MSG+o[1]),this.selection.clear(),this.getAllData()},o=>{this.translateService.get("messageSystem.deletefail").subscribe(n=>d.Q.DELETE_FAILSE_MSG=n),this.notificationService.printErrorMessage(d.Q.DELETE_FAILSE_MSG)}),this.preventAbuse=!1}ngAfterViewInit(){this.paginator._intl.itemsPerPageLabel=this.pagin.setLable,this.paginator._intl.firstPageLabel=this.pagin.firstButton,this.paginator._intl.nextPageLabel=this.pagin.nextButton,this.paginator._intl.lastPageLabel=this.pagin.lastButton,this.paginator._intl.previousPageLabel=this.pagin.preButton}onChangePage(e){this.page=e.pageIndex,this.pageSize=e.pageSize,this.getAllData()}checkConnection(e,o){this.connectedDev=!1,e.source.selected&&this.dataService.getDevice("idemiadevice/connect?devId="+o.devId).subscribe(i=>{this.connectedDev=i.connected},i=>{this.connectedDev=!1})}getCaNo(){0!=this.devId&&this.dataService.getDevice("idemiadevice/getidcard?devId="+this.devId).subscribe(e=>{this.connectedDev=e.connected,this.connectedDev&&this.Form.controls.caNo.setValue(e.cardId)},e=>{this.connectedDev=!1})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(v.D),t.Y36(g.uw),t.Y36(N.g),t.Y36(A.d),t.Y36(S.sK),t.Y36(c.qu),t.Y36(u.uU))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-t-card-no"]],viewQuery:function(e,o){if(1&e&&(t.Gf(y.NW,5),t.Gf(U.YE,5),t.Gf(j,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.paginator=n.first),t.iGM(n=t.CRH())&&(o.sort=n.first),t.iGM(n=t.CRH())&&(o.dialogTemplate=n.first)}},decls:29,vars:18,consts:[["color","red"],["progressBar",""],["color","primary"],["fxLayout.xl","row","fxLayout.lg","row","fxLayout.md","row","fxLayout.xs","column"],["fxFlex","","fxLayoutAlign","satrt center"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["color","warn","mat-raised-button","",3,"disabled","click",4,"ngIf"],["fxFlex",""],["appearance","standard","ngClass.md","width100"],["matInput","",3,"placeholder","keyup"],["inputSearch",""],["class","mat-elevation-z8 table-container",4,"ngIf"],["modal",""],["mat-raised-button","","color","primary",3,"click"],["color","warn","mat-raised-button","",3,"disabled","click"],[1,"mat-elevation-z8","table-container"],[1,"res-table-container"],["mat-table","","matSort","",1,"example-table",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","","class","checkbox-col",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","position"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","employeeName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","caNumber"],["matColumnDef","caNo"],["matColumnDef","caStatus"],["matColumnDef","action","stickyEnd",""],["mat-header-cell","","class","action-col",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["pageSize","pageSize","showFirstLastButtons","","aria-label","Select page of appRoles elements",3,"pageSizeOptions","pageIndex","length","disabled","page"],["mat-header-cell","",1,"checkbox-col"],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],["mat-header-cell",""],["mat-header-cell","","mat-sort-header",""],[2,"margin-left","30px",3,"disableRipple","checked","click"],["mat-header-cell","",1,"action-col"],["href","javascript:void(0)","color","primary",3,"matTooltip","click",4,"ngIf"],["href","javascript:void(0)","color","primary",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""],["action","",3,"formGroup"],["mat-dialog-title",""],[1,"mat-typography",2,"height","400px"],["fxLayout.gt-xs","row","fxLayout.lt-xs","column"],["fxFlex.gt-xs","45","fxFlex.lt-xs","100","appearance","outline"],["type","text","aria-label","","matInput","",3,"readonly","placeholder","formControl","matAutocomplete"],["type","button","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[3,"displayWith"],["autoEmployee","matAutocomplete"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],[4,"ngIf"],["fxFlex.gt-xs","45","fxFlex.lt-xs","100","fxFlexOffset.gt-xs","5","fxFlexOffset.lt-xs","0","appearance","outline"],["formControlName","caTypeCheck",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","caNumber",3,"placeholder"],["cardNumber",""],["align","end"],["fxFlex.gt-xs","45","fxFlex.lt-xs","100","fxFlexOffset.gt-xs","5","appearance","outline"],["matInput","","formControlName","caNo",3,"readonly","placeholder"],["cardNo",""],["fxFlex.gt-xs","45","fxFlex.lt-xs","100","appearance","outline",2,"margin-right","5px"],[3,"value","disabled","valueChange"],["fxFlex.gt-xs","45","fxFlex.lt-xs","100","fxFlexOffset.gt-xs","5"],["mat-stroked-button","","color","primary",3,"disabled","click"],["fxLayout.xl","row","fxLayout.lg","row","fxLayout.md","row","fxLayout.xs","column","fxLayoutGap","center center"],["appearance","outline"],["type","date","matInput","","formControlName","applyDate",3,"placeholder"],["fxFlex","","fxLayoutAlign","center",2,"line-height","60px"],[2,"margin-left","10px","margin-bottom","6px","margin-right","20px",3,"ngModel","ngModelOptions","ngModelChange","change"],["type","date","formControlName","expriedDate","matInput","",3,"placeholder"],[3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],["align","center"],["mat-stroked-button","","color","warn","mat-dialog-close","",3,"click"],["mat-stroked-button","","color","primary","type","submit",3,"click"],["type","button","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"value","onSelectionChange"],[3,"value"],["formControlName","caStatus",2,"margin-left","10px","margin-bottom","6px","margin-right","20px"],[3,"ngModel","ngModelOptions","ngModelChange"],["value","caStatus",2,"margin","0 15px"],["value","caDamaged",2,"margin","0 15px"],["value","caLost",2,"margin","0 15px"],["value","destroyed",2,"margin","0 15px"]],template:function(e,o){1&e&&(t._UZ(0,"ng-progress",0,1),t.TgZ(2,"mat-card"),t.TgZ(3,"div"),t.TgZ(4,"mat-card-title",2),t._uU(5),t.ALo(6,"translate"),t.qZA(),t._UZ(7,"mat-divider"),t._UZ(8,"br"),t._UZ(9,"br"),t.TgZ(10,"div",3),t.TgZ(11,"div",4),t.YNc(12,z,3,3,"button",5),t.ALo(13,"userRoles"),t.YNc(14,$,3,4,"button",6),t.ALo(15,"userRoles"),t.qZA(),t._UZ(16,"div",7),t.TgZ(17,"div",7),t.TgZ(18,"mat-form-field",8),t.TgZ(19,"mat-label"),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"input",9,10),t.NdJ("keyup",function(i){return o.applyFilter(i)}),t.ALo(24,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(25,gt,27,8,"div",11),t.ALo(26,"userRoles"),t.qZA(),t.YNc(27,yt,86,78,"ng-template",null,12,t.W1O)),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,6,"TCardNo.CardTitle")),t.xp6(7),t.Q6J("ngIf",t.lcZ(13,8,"CreateTCardNo")),t.xp6(2),t.Q6J("ngIf",t.lcZ(15,10,"LockTCardNo")),t.xp6(6),t.hij(" ",t.lcZ(21,12,"button.searchButton"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(24,14,"button.searchPlaceholder")),t.xp6(3),t.Q6J("ngIf",t.lcZ(26,16,"ViewTCardNo")))},directives:[Z.Yh,F.a8,F.n5,V.d,h.xw,h.yH,h.Wh,u.O5,_.KE,J.oO,_.hX,w.Nt,R.lW,m.BZ,m.w1,m.fO,m.Dz,m.as,m.nj,y.NW,m.ge,Y.oG,m.ev,H.gM,B.Hw,m.XQ,m.Gk,c._Y,c.JL,c.sg,g.uh,g.xY,c.Fj,D.ZL,c.JJ,c.oH,D.XC,u.sg,h.UT,G.gD,c.u,_.bx,h.SQ,c.On,g.H8,g.ZT,_.R9,P.ey,_.TO,f.VQ,f.U0],pipes:[S.X$,T.v,u.Ov],styles:[""]}),a})()}];let St=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[v.D,N.g,A.d,u.uU],imports:[[u.ez,q.q,f.Fk,T.a,I.Bz.forChild(bt),Z.Q8.withConfig({spinnerPosition:"right",color:"#red"}),O.bj]]}),a})()}}]);